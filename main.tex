\documentclass[11pt]{article}
\usepackage[margin=1in]{geometry}
% \usepackage{CJKutf8}
%\linespread{0.985}

\hbadness=99999

\usepackage[
    backend=biber,
    maxnames=20,        % Limits the maximum number of author names to display before abbreviating with "et al."
    style=nature,       % Sets the citation style to 'nature,' which is commonly used in scientific papers.
    defernumbers=true,  % Delays the assignment of citation numbers until the end of the document, allowing for the correct order of citations within each bibliography section.
]{biblatex}
\addbibresource{ref.bib}

%template packages
\usepackage{longtable}
\usepackage{bookmark}
\usepackage{fontawesome5}
\usepackage{ragged2e}
\usepackage{soul}
\usepackage[T1]{fontenc}
\usepackage{kpfonts} % More professional font
% \usepackage[default]{sourcecodepro} % Code-like font
\usepackage{emoji}

% Control hyperlinks and colors
% CUSTOM COLORS INCLUDED DIRECTLY AFTER \begin{document}
\usepackage{xcolor}
\usepackage{hyperref}
\hypersetup{
    colorlinks=true,        % Enable colored links
    breaklinks=true,        % Allow links to break across lines
    linkcolor=cornflowerblue,    % Color of internal links
    urlcolor=cornflowerblue,     % Color of URL links
    anchorcolor=cornflowerblue,  % Color of anchors
    citecolor=cornflowerblue,    % Color of citations
    pdftitle={Qile Yang's CV},   % Title of the PDF
    pdfauthor={Qile Yang}, % Author of the PDF
    bookmarksopen=true,      % Open bookmarks panel at start
}

%%% CONVENIENCE FUNCTIONS GO HERE %%%
%%% ----------------------------- %%%

\newcommand{\myinput}[1]{
  \input{include/#1.tex}
}

\newcommand{\socialicon}[2]{
  \hypersetup{hidelinks}
  \href{https://#2}{#1}
}

%%% ----------------------------- %%%

\begin{document}
\input{config/colors.tex} % Load custom colors from colors file

\begin{center}
  \Large\textbf{Qile Yang \textcolor{gray}{| \emph{Curriculum Vitae}}}\normalsize \\
  \href{mailto:qile.yang@berkeley.edu}{qile [dot] yang [at] berkeley [dot] edu} \\
  \socialicon{\faGlobe}{qile0317.github.io}
  \socialicon{\faLinkedin}{linkedin.com/in/qile0317}
  \socialicon{\faGithub}{github.com/Qile0317}
  \socialicon{\faGoogle}{scholar.google.com/citations?user=IsJeImQAAAAJ&hl=en}
  \socialicon{\faResearchgate}{www.researchgate.net/profile/Qile-Yang-2}
  \socialicon{\faOrcid}{orcid.org/my-orcid?orcid=0009-0005-0148-2499}
\end{center}

% Ensure right side margin is not surpassed by bibliography and the right margin is aligned throughout
\RaggedRight

\pdfbookmark[1]{Education}{}
\section*{Education}
\myinput{education}

\pdfbookmark[1]{Research Experience}{exp_research}
\section*{Research Experience}
\label{exp_research}
\myinput{exp_research}

\pdfbookmark[1]{Awards \& Honors}{awards}
\section*{Awards \& Honors}
\label{awards}
\myinput{awards}

\newpage

\pdfbookmark[1]{Publications}{pubs}
\section*{Publications}
\label{pubs}

% % Add equal contribution dagger
% \vspace{-.75em}
% \small
% $\dagger \rightarrow$ Equal contribution
% \normalsize


\pdfbookmark[2]{Journal Articles}{journal-article}
\subsection*{Journal Articles}
\label{journal-article}
\newrefcontext[labelprefix=J]

\nocite{*} % Ensures un-cited items are included
\printbibliography[
    type=article,
    heading=none,
    resetnumbers=true,
    keyword=J
]

% \pdfbookmark[2]{Preprints}{preprints}
% \subsection*{Preprints}
% \label{preprints}
% \newrefcontext[labelprefix=B]
% \printbibliography[heading=none,resetnumbers=true,keyword=B]


\pdfbookmark[2]{Working papers}{working-papers}
\subsection*{Working papers}
\label{working-papers}
\newrefcontext[labelprefix=W]
\printbibliography[heading=none,resetnumbers=true,keyword=R]

% \pdfbookmark[1]{Tools \& Software}{tools}
% \section*{Tools \& Software}
% \label{tools}
% \myinput{tools.tex}

\pdfbookmark[1]{Presentations}{presentations}
\section*{Presentations}
\label{presentations}

\pdfbookmark[2]{Posters}{posters}
\subsection*{Posters}
\label{posters}
\newrefcontext[labelprefix=P]        
\printbibliography[heading=none,resetnumbers=true,keyword=P]

\pdfbookmark[2]{Demonstrations \& Tutorials}{demos}
\subsection*{Demonstrations \& Tutorials}
\label{demos}
\newrefcontext[labelprefix=D] \printbibliography[heading=none,resetnumbers=true,keyword=D]

% \pdfbookmark[1]{Projects}{projects}
% \section*{Projects}
% \label{projects}
% \newrefcontext[labelprefix=X]        
% \printbibliography[heading=none,resetnumbers=true,keyword=X]

\newpage
\pdfbookmark[1]{Media}{Media}
\section*{Selected Media}
\label{media}
\myinput{media}

% \pdfbookmark[1]{Other Experience}{exp_other}
% \section*{Other Experience}
% \label{exp_other}
% \myinput{exp_other.tex}

\pdfbookmark[1]{Organizations}{Organizations}
\section*{Professional Organizations}
\label{organizations}
\myinput{organizations}

% \newpage
\pdfbookmark[1]{Relevant Coursework}{coursework}
\section*{Relevant Coursework}
\label{coursework}
\myinput{coursework}

% Pretty ending with the date last updated
\centering
\rule{0.25\linewidth}{0.4pt}\\
\medskip
Last updated: \today

\end{document}
